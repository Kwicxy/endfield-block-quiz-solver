limits = [
    [4, 2, 2, 2],
    [4, 4, 1, 1]
]
shape = [
    [3, 3, 4, 4],
    [3, 1, 1, 4],
    [2, 0, -1, 0],
    [2, 0, 0, -1]
]